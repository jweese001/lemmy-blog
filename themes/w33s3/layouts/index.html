{{ define "main" }}
<div class="home-header">
  <h1 class="home-title">{{ .Site.Title }}</h1>
  <p class="home-subtitle">{{ .Site.Params.description }}</p>
</div>

{{ if .Site.Params.topics }}
<div class="topics-list">
  {{ range .Site.Params.topics }}
  <a href="{{ $.Site.BaseURL }}tags/{{ . | urlize }}" class="topic-tag">{{ . }}</a>
  {{ end }}
</div>
{{ end }}

{{ $posts := where .Site.RegularPages "Section" "posts" }}
{{ $featured := first 1 $posts }}
{{ $rest := after 1 $posts | first 9 }}

<!-- Featured Post -->
{{ range $featured }}
<section class="featured-section">
  <a href="{{ .Permalink }}" class="post-link">
    <article class="featured-card">
      {{ with .Params.image }}
      <img src="{{ $.Site.BaseURL }}{{ strings.TrimPrefix "/" . }}" alt="{{ $.Title }}" class="featured-image">
      {{ else }}
      <div class="featured-image"></div>
      {{ end }}
      <div class="featured-content">
        <div class="featured-header">
          <span class="featured-label">Latest</span>
          <span class="post-date">{{ .Date.Format "Jan 2, 2006" }}</span>
        </div>
        <h2 class="featured-title">{{ .Title }}</h2>
        <p class="featured-excerpt">{{ .Summary | plainify | truncate 200 }}</p>
        <div class="featured-footer">
          {{ with .Params.tags }}
          <div class="post-tags">
            {{ range first 2 . }}
            <span class="tag">{{ . }}</span>
            {{ end }}
          </div>
          {{ end }}
          <span class="read-more">Continue reading</span>
        </div>
      </div>
    </article>
  </a>
</section>
{{ end }}

<!-- Remaining Posts -->
{{ if $rest }}
<section class="posts-section">
  <h2 class="section-title">More Posts</h2>
  <ul class="post-grid">
    {{ range $rest }}
    <li class="post-item">
      <a href="{{ .Permalink }}" class="post-link">
        <article class="post-card">
          {{ with .Params.image }}
          <img src="{{ $.Site.BaseURL }}{{ strings.TrimPrefix "/" . }}" alt="{{ $.Title }}" class="post-image">
          {{ else }}
          <div class="post-image"></div>
          {{ end }}
          <div class="post-content">
            <h3 class="post-title">{{ .Title }}</h3>
            <p class="post-excerpt">{{ .Summary | plainify | truncate 120 }}</p>
            <div class="post-meta">
              <span class="post-date">{{ .Date.Format "Jan 2, 2006" }}</span>
              {{ with .Params.tags }}
              <div class="post-tags">
                {{ range first 1 . }}
                <span class="tag">{{ . }}</span>
                {{ end }}
              </div>
              {{ end }}
            </div>
            <span class="read-more">Continue reading</span>
          </div>
        </article>
      </a>
    </li>
    {{ end }}
  </ul>
</section>
{{ end }}
{{ end }}
