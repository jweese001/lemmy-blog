# CLAUDE.md - Lemmy's Mic Blog

This file guides Claude Code when working on the Lemmy's Mic blog project.

## Quick Reference for Lemmy (Telegram Bot)

**Note:** Scripts use a virtual environment. Use `.venv/bin/python` or activate it first.

**To create and publish a blog post:**

```bash
cd ~/lemmy-blog

# 1. Generate workflow for FlowBoard UI (can edit before generating)
.venv/bin/python scripts/generate_workflow.py "Post Title" "Scene" --slug my-post --model mock

# 2. Or direct API generation (requires GEMINI_API_KEY)
.venv/bin/python scripts/generate_hero.py "Post Title" "Scene" --slug my-post-slug

# 3. Create post file
.venv/bin/python scripts/create_post.py \
  --title "Post Title" \
  --tags indie-games tech \
  --scene "Scene for hero image" \
  --description "SEO description" \
  --deploy

# 4. Or write markdown directly: content/posts/my-post-slug.md
```

**Quick deploy:**
```bash
cd ~/lemmy-blog && git add -A && git commit -m "Add post: Title" && git push
```

**Dev server:**
```bash
hugo server --bind 0.0.0.0 -p 1313
```

---

## Project Overview

**Lemmy's Mic** is an AI-generated blog built with Hugo, deployed on GitHub Pages.

| Component | Details |
|-----------|---------|
| Site | Hugo static site generator |
| Theme | Custom "w33s3" (dark, minimalist) |
| Hosting | GitHub Pages (auto-deploys on git push) |
| Images | Generated via Gemini API (FlowBoard style) |
| Repo | github.com/jweese001/lemmy-blog (private) |
| Live URL | https://jweese001.github.io/lemmy-blog/ |

## Directory Structure

```
~/lemmy-blog/
├── hugo.toml              # Site configuration
├── .github/workflows/hugo.yml  # GitHub Pages deployment
├── content/
│   ├── posts/             # Blog posts (markdown)
│   └── about.md           # About page
├── static/images/         # Hero images (hero-{slug}.png)
├── themes/w33s3/
│   ├── assets/css/style.css   # Main stylesheet
│   └── layouts/               # Hugo templates
├── scripts/
│   ├── generate_hero.py   # Generate hero images via Gemini
│   └── create_post.py     # Full post creation pipeline
├── CLAUDE.md              # This file
├── PLANNING.md            # Detailed project planning
└── STYLE-GUIDE.md         # Design system documentation
```

## Creating Posts

### Post Frontmatter Format

```yaml
---
title: "Post Title Here"
date: 2026-02-05T12:00:00-05:00
draft: false
tags: ["indie-games", "reviews"]
image: "/images/hero-my-post-slug.png"
description: "Brief description for SEO."
---
```

### Valid Tags

| Tag | Description |
|-----|-------------|
| `indie-games` | Game reviews, studio spotlights, game jams |
| `e-bikes` | Electric bikes, urban mobility, reviews |
| `punk-music` | Albums, history, scene reports |
| `kava-bars` | Culture, locations, experiences |
| `tech` | Development, tools, experiments |
| `meta` | About the blog itself |

### Post Structure

```markdown
## Introduction
Hook the reader, establish relevance.

## Main Content
Research-backed insights, organized with headers.

## Conclusion
Summary, call to action, or reflection.

---
*Generated by Lemmy using [FlowBoard](https://jweese001.github.io/flowboard-demo/)*
```

## Hero Image Generation

Two approaches available:

### Option A: FlowBoard UI (Recommended for manual control)

Generate a workflow file, then use FlowBoard UI to edit and generate:

```bash
# Generate workflow JSON
.venv/bin/python scripts/generate_workflow.py "Post Title" "Scene description" --slug post-slug

# For testing (no API key needed)
.venv/bin/python scripts/generate_workflow.py "Post Title" "Scene" --model mock --slug test

# Then open FlowBoard:
cd ~/claude-code-telegram/claude-code-telegram/flow-board/client && npm run dev
# Open http://localhost:5173/flow-board/
# File > Open > select workflows/blog-{slug}.json
# Edit nodes if needed, then Generate
# Save image to static/images/hero-{slug}.png
```

### Option B: Direct API (Automated)

```bash
# Direct Gemini API call (requires GEMINI_API_KEY)
.venv/bin/python scripts/generate_hero.py "Post Title" "Scene description" --slug post-slug

# Dry run (preview prompt without generating)
.venv/bin/python scripts/generate_hero.py "Title" "Scene" --dry-run
```

### Environment Setup

For direct API generation, set `GEMINI_API_KEY`:
```bash
export GEMINI_API_KEY="your-api-key-here"
```

FlowBoard UI stores API keys in browser localStorage (Settings panel).

### w33s3 Style (Applied Automatically)

All hero images use this consistent style:
- Dark, moody atmosphere with high contrast
- Cinematic composition with neon accents
- Professional photography feel
- Deep blacks with dramatic shadows
- No text or watermarks

### Detailed FlowBoard Guide

**For comprehensive FlowBoard instructions, read: `FLOWBOARD-GUIDE.md`**

This includes:
- Node types and their purposes
- Example workflows for each blog topic (indie games, e-bikes, punk, kava, tech)
- Tips for better images
- Troubleshooting

### Fallback

If image generation fails, the script creates a dark gradient fallback.

## Full Post Pipeline

### Using create_post.py

```bash
# Create post with image and deploy
python scripts/create_post.py \
  --title "My Amazing Post" \
  --tags indie-games tech \
  --scene "Futuristic gaming setup with neon lights" \
  --description "An exploration of indie gaming trends" \
  --deploy

# Create draft (won't publish)
python scripts/create_post.py \
  --title "Work in Progress" \
  --tags tech \
  --draft

# Skip image generation
python scripts/create_post.py \
  --title "Quick Post" \
  --tags meta \
  --no-image
```

### Manual Post Creation

1. Create file: `content/posts/{slug}.md`
2. Add frontmatter (see format above)
3. Write content
4. Generate image: `python scripts/generate_hero.py "Title" "Scene" --slug {slug}`
5. Deploy: `git add -A && git commit -m "Add post: Title" && git push`

## Deployment

GitHub Pages auto-deploys when you push to main:

```bash
cd ~/lemmy-blog
git add -A
git commit -m "Add post: Post Title"
git push
# GitHub Actions builds and deploys within ~1-2 minutes
# View status: https://github.com/jweese001/lemmy-blog/actions
```

## Styling Reference

### Design System (w33s3)

| Property | Value |
|----------|-------|
| Background | `#0a0a0b` |
| Secondary BG | `#111113` |
| Primary Text | `#efefef` |
| Muted Text | `#a0a0a5` |
| Accent Blue | `#3b82f6` |
| Accent Green | `#10b981` |

### Fonts

- Headers: Instrument Serif
- Body: Sora
- Code: JetBrains Mono

### CSS Location

`themes/w33s3/assets/css/style.css`

## Commands Reference

```bash
# Development
cd ~/lemmy-blog
hugo server --bind 0.0.0.0 -p 1313  # Dev server (accessible on network)
hugo                                 # Build site
hugo --minify                        # Production build

# Image Generation
python scripts/generate_hero.py "Title" "Scene" --slug slug-name
python scripts/generate_hero.py "Title" "Scene" --dry-run  # Preview only

# Post Creation
python scripts/create_post.py --title "Title" --tags tag1 tag2 --scene "Scene"
python scripts/create_post.py --title "Title" --draft  # Create draft

# Deployment
git add -A && git commit -m "Add post: Title" && git push
```

## Troubleshooting

### Posts Not Showing

1. Check date isn't in the future
2. Check `draft: false`
3. Run `hugo` to see build errors

### Image Generation Fails

1. Check `GEMINI_API_KEY` is set
2. Try `--dry-run` to see the prompt
3. Fallback gradient will be created

### Build Fails on GitHub Pages

1. Test locally with `hugo --minify`
2. Check workflow status: https://github.com/jweese001/lemmy-blog/actions
3. Review `.github/workflows/hugo.yml` for Hugo version

## Related Files

- **FlowBoard Guide**: `~/lemmy-blog/FLOWBOARD-GUIDE.md` ← **READ THIS for image generation**
- **Planning Doc**: `~/lemmy-blog/PLANNING.md`
- **Style Guide**: `~/lemmy-blog/STYLE-GUIDE.md`
- **FlowBoard App**: `~/claude-code-telegram/claude-code-telegram/flow-board/`
- **FlowBoard Quickstart**: `~/claude-code-telegram/claude-code-telegram/flow-board/docs/QUICKSTART.md`
- **Global Config**: `~/.claude/CLAUDE.md`

---

*This is Lemmy's blog. That's the way I like it, baby...*

## Article Illustration Guidelines

**CRITICAL: Every article gets CUSTOM art based on its content.**

### The Rule

Read the article first. Extract visual hooks from the content itself. Never default to generic category imagery.

### Bad (Generic Category Art)
- Punk article → mohawk/leather jacket self-portrait
- Indie games → generic pixel character
- E-bikes → random bike on street
- Kava → generic tiki aesthetic

### Good (Content-Specific Art)
Ask: What does THIS article actually discuss?

| Article Subject | Visual Approach |
|-----------------|-----------------|
| CBGB's history | The iconic awning, Bowery street scene, venue interior |
| Specific album | Album art interpretation, recording era aesthetic |
| Regional punk scene | That city's landmarks, local venue culture |
| Artist profile (Molly Tuttle) | Her actual context: acoustic guitar, bluegrass/punk fusion, stage performance |
| Game studio spotlight | Their actual game art style, studio aesthetic |
| Specific e-bike model | That bike's design language, intended use environment |

### Process

1. **Read the full article**
2. **List 3-5 specific visual elements mentioned** (places, objects, people, events)
3. **Choose the most compelling visual hook**
4. **Write scene description based on THAT, not the category**

### Style Stays Consistent

Keep the w33s3 style (dark, moody, cinematic, neon accents). Only change the SUBJECT MATTER to match article content.
